package fr.thesmyler.log4shell;

public class Main {

    public static void main(String... args) throws Exception {
        new Thread(() -> {
            try {
                Thread.sleep(15000);
            } catch (InterruptedException e) {
                throw new RuntimeException(e);
            }
            System.out.println("Timeout");
            System.exit(2);
        }).start();
        ExploitTester tester = new ExploitTester(args[0], Integer.parseInt(args[1]), args[2], Integer.parseInt(args[3]), Integer.parseInt(args[4]));
        String flag = tester.getFlag();
        if (flag != null) {
            System.out.println(flag);
            System.exit(0);
        }
        System.exit(1);
    }
}
